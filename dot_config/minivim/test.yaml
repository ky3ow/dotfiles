
	local M = {}

	---@param bufnr integer
	---@param method string
	M.request_sync = function(bufnr, method)
		local client = vim.lsp.get_clients({ name = "yamlls", bufnr = bufnr })[1]

		if client then
			local response, error = client:request_sync(
				method,
				{ vim.uri_from_bufnr(bufnr) },
				1000,
				bufnr)

			return response
		end
	end

	M.get_all_jsonschemas = function(bufnr)
		return M.request_sync(bufnr, "yaml/get/all/jsonSchemas")
	end

	-- get schema used for {bufnr} from the yamlls attached to it
	---@param bufnr number
	M.get_jsonschema = function(bufnr)
		return M.request_sync(bufnr, "yaml/get/jsonSchema")
	end

	_G.yamlschemas = M.get_all_jsonschemas(0).result
